(()=>{var e,t,r,s,a={7:(e,t,r)=>{"use strict";r.d(t,{u:()=>s});const s=(e,t)=>{t.json({message:"Hello from the backend!"})}},31:e=>{"use strict";e.exports=require("sequelize")},37:e=>{"use strict";e.exports=require("mongoose")},77:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});const s=class{static validateAddressFields(e,t={required:!1}){try{const{userId:r,street:s,number:a,complement:i,neighborhood:n,city:o,state:d,zipCode:l,country:u}=e,c=["userId","street","number","neighborhood","city","state","zipCode"];if(t.required){const t=c.filter((t=>void 0===e[t]||null===e[t]));if(t.length>0)throw new Error(`Missing required fields: ${t.join(", ")}`)}if(r&&"number"!=typeof r)throw new Error("Invalid userId: must be a number.");if(s&&"string"!=typeof s)throw new Error("Invalid street: must be a string.");if(a&&"number"!=typeof a&&"string"!=typeof a)throw new Error("Invalid number: must be a string or number.");if(i&&"string"!=typeof i)throw new Error("Invalid complement: must be a string.");if(n&&"string"!=typeof n)throw new Error("Invalid neighborhood: must be a string.");if(o&&"string"!=typeof o)throw new Error("Invalid city: must be a string.");if(d&&"string"!=typeof d)throw new Error("Invalid state: must be a string.");if(l&&("string"!=typeof l||!/^\d{5}(-\d{4})?$/.test(l)))throw new Error("Invalid zipCode: must be a valid ZIP code (e.g., 12345 or 12345-6789).");if(u&&"string"!=typeof u)throw new Error("Invalid country: must be a string.");return null}catch(e){return{status:400,error:e.message}}}}},78:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});const s=require("swagger-jsdoc");var a=r.n(s);const i=require("swagger-ui-express");var n=r.n(i);const o=Number(process.env.PORT)||8765,d="true"===process.env.HTTPS_ENABLED?"https":"http",l=process.env.HOST||"localhost",u={definition:{openapi:"3.0.0",info:{title:"Your API Documentation",version:"1.0.0",description:"API documentation for your Node.js application"},servers:[{url:process.env.FRONTEND_URL||`${d}://${l}:${o}`,description:"Local server"}]},apis:["./src/routes/*"]},c=a()(u),h={port:o,protocol:d,host:l,swaggerEnabled:"true"===process.env.SWAGGER_ENABLED||!0,swaggerRoute:process.env.SWAGGER_ROUTE||"/api-docs"},v=e=>{h.swaggerEnabled?(e.use(h.swaggerRoute,n().serve,n().setup(c)),console.log(`Swagger UI is available at ${h.swaggerRoute}`)):console.log("Swagger UI is disabled.")}},85:e=>{"use strict";e.exports=require("dotenv-expand")},124:e=>{"use strict";e.exports=require("winston")},139:e=>{"use strict";e.exports=require("csrf-csrf")},188:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(252),a=r(898);class i{static getData(e,t){return e.body[t]||e.params[t]}static handleValidationResult(e,t){if(e.valid)t.status(200).json({message:"Validation successful"});else{const r=e.status||400;t.status(r).json({error:e.error})}}static validateFields(e,t){const r={username:this.getData(e,"username"),name:this.getData(e,"name"),surname:this.getData(e,"surname"),email:this.getData(e,"email"),password:this.getData(e,"password"),role:this.getData(e,"role")},s=a.A.validateFields(r);this.handleValidationResult(s,t)}static validatePassport(e,t){const r=this.getData(e,"passportNumber"),s=this.getData(e,"countryCode");if(!r||!s)return void t.status(400).json({error:"Passport number and country code are required."});const i=a.A.validatePassport(r,s);this.handleValidationResult(i,t)}static validateCPF(e,t){const r=this.getData(e,"cpfNumber");if(!r)return void t.status(400).json({error:"CPF number is required."});const s=a.A.validateCPF(r);this.handleValidationResult(s,t)}static validateRG(e,t){const r=this.getData(e,"rgNumber");if(!r)return void t.status(400).json({error:"RG number is required."});const s=a.A.validateRG(r);this.handleValidationResult(s,t)}static validateSUS(e,t){const r=this.getData(e,"susNumber");if(!r)return void t.status(400).json({error:"SUS number is required."});const s=a.A.validateSUS(r);this.handleValidationResult(s,t)}static validateCNH(e,t){const r=this.getData(e,"cnhNumber");if(!r)return void t.status(400).json({error:"CNH number is required."});const s=a.A.validateCNH(r);this.handleValidationResult(s,t)}static validateCTPS(e,t){const r=this.getData(e,"ctpsNumber");if(!r)return void t.status(400).json({error:"CTPS number is required."});const s=a.A.validateCTPS(r);this.handleValidationResult(s,t)}static validateCRM(e,t){const r=this.getData(e,"crmNumber");if(!r)return void t.status(400).json({error:"CRM number is required."});const s=a.A.validateCRM(r);this.handleValidationResult(s,t)}static validateOAB(e,t){const r=this.getData(e,"oabNumber");if(!r)return void t.status(400).json({error:"OAB number is required."});const s=a.A.validateOAB(r);this.handleValidationResult(s,t)}static validateCREA(e,t){const r=this.getData(e,"creaNumber");if(!r)return void t.status(400).json({error:"CREA number is required."});const s=a.A.validateCREA(r);this.handleValidationResult(s,t)}static validatePIS(e,t){const r=this.getData(e,"pis");if(!r)return void t.status(400).json({error:"PIS number is required."});const s=a.A.validatePIS(r);this.handleValidationResult(s,t)}static validateCNPJ(e,t){const r=this.getData(e,"cnpj");if(!r)return void t.status(400).json({error:"CNPJ number is required."});const s=a.A.validateCNPJ(r);this.handleValidationResult(s,t)}static validateUSDriversLicense(e,t){const r=this.getData(e,"licenseNumber");if(!r)return void t.status(400).json({error:"US Driver's License number is required."});const s=a.A.validateUSDriversLicense(r);this.handleValidationResult(s,t)}static validateUSSSN(e,t){const r=this.getData(e,"ssn");if(!r)return void t.status(400).json({error:"US SSN is required."});const s=a.A.validateUSSSN(r);this.handleValidationResult(s,t)}static validateUSMilitaryID(e,t){const r=this.getData(e,"militaryID");if(!r)return void t.status(400).json({error:"US Military ID is required."});const s=a.A.validateUSMilitaryID(r);this.handleValidationResult(s,t)}static validateUKNINumber(e,t){const r=this.getData(e,"niNumber");if(!r)return void t.status(400).json({error:"UK NI Number is required."});const s=a.A.validateUKNINumber(r);this.handleValidationResult(s,t)}static validateCanadianSIN(e,t){const r=this.getData(e,"sinNumber");if(!r)return void t.status(400).json({error:"Canadian SIN Number is required."});const s=a.A.validateCanadianSIN(r);this.handleValidationResult(s,t)}static validateMexicanCURP(e,t){const r=this.getData(e,"curpNumber");if(!r)return void t.status(400).json({error:"Mexican CURP Number is required."});const s=a.A.validateMexicanCURP(r);this.handleValidationResult(s,t)}static validateSouthKoreanRRN(e,t){const r=this.getData(e,"rrnNumber");if(!r)return void t.status(400).json({error:"South Korean RRN Number is required."});const s=a.A.validateSouthKoreanRRN(r);this.handleValidationResult(s,t)}static validateGermanPersonalausweis(e,t){const r=this.getData(e,"idNumber");if(!r)return void t.status(400).json({error:"German Personalausweis Number is required."});const s=a.A.validateGermanPersonalausweis(r);this.handleValidationResult(s,t)}}const n=(0,s.Router)();n.get("/validate-cnh/:cnhNumber?",i.validateFields),n.get("/validate-cnh/:cnhNumber?",i.validatePassport),n.get("/validate-cnh/:cnhNumber?",i.validateCPF),n.get("/validate-cnh/:cnhNumber?",i.validateRG),n.get("/validate-cnh/:cnhNumber?",i.validateSUS),n.get("/validate-cnh/:cnhNumber?",i.validateCNH),n.get("/validate-ctps/:ctpsNumber?",i.validateCTPS),n.get("/validate-crm/:crmNumber?",i.validateCRM),n.get("/validate-oab/:oabNumber?",i.validateOAB),n.get("/validate-crea/:creaNumber?",i.validateCREA),n.get("/validate-pis-pasep/:pis?",i.validatePIS),n.get("/validate-cnpj/:cnpj?",i.validateCNPJ),n.get("/validate-us-license/:licenseNumber?",i.validateUSDriversLicense),n.get("/validate-us-ssn/:ssn?",i.validateUSSSN),n.get("/validate-us-military-id/:militaryID?",i.validateUSMilitaryID),n.get("/validate-uk-ni/:niNumber?",i.validateUKNINumber),n.get("/validate-ca-sin/:sinNumber?",i.validateCanadianSIN),n.get("/validate-mx-curp/:curpNumber?",i.validateMexicanCURP),n.get("/validate-kr-rrn/:rrnNumber?",i.validateSouthKoreanRRN),n.get("/validate-de-personalausweis/:idNumber?",i.validateGermanPersonalausweis);const o=n},219:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=219,e.exports=t},238:e=>{"use strict";e.exports=require("url")},252:e=>{"use strict";e.exports=require("express")},259:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>$}),r(469);var a=r(85),i=r.n(a),n=r(928),o=r.n(n),d=r(896),l=r.n(d),u=r(829),c=r.n(u),h=r(486),v=r.n(h),p=r(859),m=r(898),f=r(451),g=r(845),y=r(31),A=r(818),I=r.n(A),w=e([p]);p=(w.then?(await w)():w)[0];const b=I().config();let S;i().expand(b);try{S=await(0,g.E)("file:///C:/Users/enricky.hipolito/Documents/gitjhonson/Node-BoilerPlate/src/controllers/userController.ts")}catch(e){throw console.log("Error loading user model:",e),new Error("Failed to load user model")}const P=(0,f.y)(S);class E{getProfilePicturePaths(e){const t=o().resolve(process.env.UPLOAD_DIR||"public/uploads"),r=o().relative(o().resolve("public"),t),s=e.file?`/${r}/${e.file.filename}`:null;return{profilePicture:s,profilePictureTruePath:s&&e.file?o().join(t,e.file.filename):null}}formatUserResponse(e,t){const r=e.toJSON();if(delete r.password,r.profilePicture){const e=`${t.protocol}://${t.get("host")}`;r.profilePicture=`${e}${r.profilePicture}`}return r}create=async(e,t)=>{try{const{profilePicture:r,profilePictureTruePath:s}=this.getProfilePicturePaths(e),{username:a,name:i,surname:n,email:o,password:d,bio:l,birthDate:u,role:c}=e.body;if(this.failedValidationAndDeletePhoto(e,t,m.A.validateFields({username:a,name:i,surname:n,email:o,password:d,role:c},{required:!1}),s))return t;if(!await this.checkFieldAvailability(e,t,"email",o,null,s))return t;if(!await this.checkFieldAvailability(e,t,"username",a,null,s))return t;const h={username:a,name:i,surname:n,email:o,password:d,bio:l,profilePicture:r,birthDate:u,role:c||"User"},v=await P.create(h);return t.status(201).json(this.formatUserResponse(v,e))}catch(e){return p.v.error("Error creating user:",e),t.status(400).json({error:e.message})}};fetchUsers=async(e,t)=>{try{const r=await P.find(e||{},{exclude:["password"],sort:P.buildSort("createdAt","DESC")});if(!r||0===r.length)return t.status(404).json({message:"No users found"});const s=r.map((e=>this.formatUserResponse(e,t.req)));return t.status(200).json(s)}catch(e){return p.v.error("Error fetching users:",e),t.status(500).json({error:"Internal server error."})}};getUsers=async(e,t)=>this.fetchUsers(null,t);getInactiveUsers=async(e,t)=>this.fetchUsers({isActive:!1},t);getActiveUsers=async(e,t)=>this.fetchUsers({isActive:!0},t);self=async(e,t)=>{try{const r=e.params.userId||e.body.userId,s=await P.findById(r,{exclude:["password"]});return s?t.status(200).json(this.formatUserResponse(s,e)):t.status(404).json({message:"User not found."})}catch(e){return p.v.error("Error fetching user:",e),t.status(500).json({error:"Internal server error."})}};update=async(e,t)=>{try{const r=e.user&&"Admin"===e.user.role?e.params.userId||e.body.userId:e.user&&e.user.id,{username:s,name:a,surname:i,email:n,password:o,bio:d,birthDate:l,role:u}=e.body,{profilePicture:c,profilePictureTruePath:h}=this.getProfilePicturePaths(e),v=await P.findById(r);if(!v)return t.status(404).json({error:"User not found."});if(this.failedValidationAndDeletePhoto(e,t,m.A.validateFields({username:s,name:a,surname:i,email:n,password:o,role:u},{required:!1}),h))return t;if(!await this.checkFieldAvailability(e,t,"email",n,v,h))return t;if(!await this.checkFieldAvailability(e,t,"username",s,v,h))return t;const p={username:s||v.username,name:a||v.name,surname:i||v.surname,email:n||v.email,bio:d||v.bio,profilePicture:c||v.profilePicture,birthDate:l||v.birthDate,role:u||v.role,...o&&{password:o}},f=await P.update(r,p);return t.status(200).json(this.formatUserResponse(f,e))}catch(e){return p.v.error("Error updating user:",e),t.status(500).json({error:"Internal server error."})}};delete=async(e,t)=>{try{const r=e.user&&"Admin"===e.user.role?e.params.userId||e.body.userId:e.user&&e.user.id,s=await P.findById(r);return s.isActive?(await P.softDelete(r),t.status(200).json({message:"User deactivated successfully.",user:this.formatUserResponse(s,e)})):t.status(400).json({error:"User already deactivated."})}catch(e){return p.v.error("Error deactivating user:",e),t.status(500).json({error:"Internal server error."})}};reactivate=async(e,t)=>{try{const r=e.params.userId||e.body.userId,s=await P.reactivate(r);return s?s.isActive?t.status(400).json({error:"User already active."}):t.status(200).json({message:"User reactivated successfully.",user:this.formatUserResponse(s,e)}):t.status(404).json({error:"User not found."})}catch(e){return p.v.error("Error reactivating user:",e),t.status(500).json({error:"Internal server error."})}};logout=async(e,t)=>{try{return"session"===process.env.TYPEAUTH?(e.session.destroy((e=>e?(p.v.error("Error destroying session:",e),t.status(500).json({error:"Could not log out, please try again."})):t.status(200).json({message:"Logged out successfully."}))),t):t.status(200).json({message:"Logout successful (JWT-based authentication)."})}catch(e){return p.v.error("Error logging out:",e),t.status(500).json({error:"Internal server error."})}};login=async(e,t)=>{try{const{email:r,password:s}=e.body,a=await P.findOne({email:r},{exclude:[]});if(!a)return t.status(401).json({error:"Invalid credentials"});if(!await v().compare(s,a.password))return t.status(401).json({error:"Invalid credentials"});if(!1===a.isActive)return t.status(403).json({error:"Account deactivated"});if(await P.update(a.id,{lastLogin:new Date}),"JWT"===process.env.TYPEAUTH){const r=process.env.JWTSECRET||"defaultsecret",s={expiresIn:process.env.JWT_EXPIRATION||"1h"},i=c().sign({id:a.id,email:a.email},r,s);return t.json({user:this.formatUserResponse(a,e),token:i})}return e.session.user={id:a.id,email:a.email},t.json({message:"Logged in successfully"})}catch(e){return p.v.error("Login error:",e),t.status(500).json({error:"Internal server error."})}};searchUsers=async(e,t)=>{try{const{page:r=1,limit:s=10,search:a,role:i,sortBy:n="createdAt",order:o="desc"}=e.query,d={isActive:!0};a&&Object.assign(d,P.buildSearchQuery(a,["name","email","username"])),i&&(d.role=i);const{count:l,rows:u}=await P.findAndCount(d,{exclude:["password"],sort:[[n,o.toUpperCase()]],offset:(Number(r)-1)*Number(s),limit:Math.min(100,Math.max(1,Number(s)))});return t.json({total:l,page:Number(r),totalPages:Math.ceil(l/Number(s)),users:u.map((t=>this.formatUserResponse(t,e)))})}catch(e){return p.v.error("Search error:",e),t.status(500).json({error:"Server error"})}};validateUser=async(e,t)=>{try{const r=await P.findOne({email:e});return r?"function"==typeof r.comparePassword?await r.comparePassword(t)?r:null:r.password&&await v().compare(t,r.password)?r:null:null}catch(e){throw p.v.error("Validation error:",e),e}};failedValidationAndDeletePhoto(e,t,r,s){return!(!r||r.valid||(s&&l().existsSync(s)&&l().unlinkSync(s),t.status(r.status).json({error:r.error||null}),0))}async checkFieldAvailability(e,t,r,s,a,i){try{if(!s)return!0;if(!a)return!await P.findOne({[r]:s})||(this.failedValidationAndDeletePhoto(e,t,{valid:!1,error:`${r} is already in use`,status:400},i),!1);if(s===a[r])return!0;const n={[r]:s,id:{[y.Op.ne]:a.id}};return!await P.findOne(n)||(this.failedValidationAndDeletePhoto(e,t,{valid:!1,error:`${r} is already in use`,status:400},i),!1)}catch(s){return p.v.error(`Field availability check error for ${r}:`,s),this.failedValidationAndDeletePhoto(e,t,{valid:!1,error:"Validation failed",status:500},i),!1}}}const $=new E;s()}catch(e){s(e)}}),1)},294:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>h});var a=r(859),i=r(845),n=r(77),o=r(451),d=e([a]);let l;a=(d.then?(await d)():d)[0];try{l=await(0,i.E)("file:///C:/Users/enricky.hipolito/Documents/gitjhonson/Node-BoilerPlate/src/controllers/addressController.ts")}catch(e){throw console.log("Error loading address model:",e),new Error("Failed to load address model")}const u=(0,o.y)(l);class c{create=async(e,t)=>{try{const{userId:r,street:s,number:a,complement:i,neighborhood:o,city:d,state:l,zipCode:c,country:h}=e.body,v=n.A.validateAddressFields({userId:r,street:s,number:a,complement:i,neighborhood:o,city:d,state:l,zipCode:c,country:h},{required:!0});if(v)return t.status(v.status).json({error:v.error});const p={userId:r,street:s,number:a,complement:i,neighborhood:o,city:d,state:l,zipCode:c,country:h},m=await u.create(p);return t.status(201).json(m)}catch(e){return a.v.error("Error creating address:",e),t.status(400).json({error:e.message})}};getByUserId=async(e,t)=>{try{if(!e.user)return t.status(401).json({error:"Unauthorized: User not authenticated."});const r="Admin"===e.user.role?e.params.userId||e.body.userId:e.user.id,s=await u.find({userId:r});return s.length?t.status(200).json(s):t.status(404).json({message:"No addresses found for this user."})}catch(e){return a.v.error("Error fetching addresses:",e),t.status(500).json({error:"Internal server error."})}};getUserAddresses=async(e,t)=>{try{const e=await u.find({});return t.status(200).json(e)}catch(e){return a.v.error("Error fetching all user addresses:",e),t.status(500).json({error:"Internal server error."})}};getAddressById=async(e,t)=>{try{const r=e.params.addressId||e.body.addressId,s=await u.findById(r);return s?t.status(200).json(s):t.status(404).json({error:"Address not found."})}catch(e){return a.v.error("Error fetching address by ID:",e),t.status(500).json({error:"Internal server error."})}};setPrimaryAddress=async(e,t)=>{try{const r=e.params.userId||e.body.userId,s=e.params.addressId||e.body.addressId;return await u.update({userId:r},{isPrimary:!1}),await u.update(s,{isPrimary:!0}),t.status(200).json({message:"Primary address updated successfully."})}catch(e){return a.v.error("Error setting primary address:",e),t.status(500).json({error:"Internal server error."})}};getPrimaryAddress=async(e,t)=>{try{const r=e.params.userId||e.body.userId,s=await u.findOne({userId:r,isPrimary:!0});return s?t.status(200).json(s):t.status(404).json({error:"Primary address not found."})}catch(e){return a.v.error("Error fetching primary address:",e),t.status(500).json({error:"Internal server error."})}};update=async(e,t)=>{try{const r=e.params.addressId||e.body.addressId,s=e.body,a=n.A.validateAddressFields(s,{required:!1});if(a)return t.status(a.status).json({error:a.error});if(!await u.findById(r))return t.status(404).json({error:"Address not found."});const i=await u.update(r,s);return t.status(200).json(i)}catch(e){return a.v.error("Error updating address:",e),t.status(400).json({error:e.message})}};delete=async(e,t)=>{try{const r=e.params.addressId||e.body.addressId;return await u.findById(r)?(await u.delete(r),t.status(200).json({message:"Address deleted successfully."})):t.status(404).json({error:"Address not found."})}catch(e){return a.v.error("Error deleting address:",e),t.status(500).json({error:"Internal server error."})}}}const h=new c;s()}catch(e){s(e)}}),1)},314:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{B:()=>v,m:()=>p});var a=r(829),i=r.n(a),n=r(859),o=(r(469),r(818)),d=r.n(o),l=r(85),u=r.n(l),c=e([n]);n=(c.then?(await c)():c)[0];const h=d().config();function v(e,t,r){const s=e.headers.authorization?.split(" ")[1];if(s)try{const t=i().verify(s,process.env.JWTSECRET||"defaultsecret");return e.user=t,void r()}catch(e){return n.v.error("Error while verifying JWT Token:",e),void t.status(401).json({error:"Unauthorized access. Invalid token."})}if(e.session&&e.session.user)return e.user=e.session.user,void r();t.status(401).json({error:"Unauthorized access. You must login to proceed."})}function p(e,t,r){"Admin"===e.user?.role?r():t.status(403).json({error:"Forbidden. You do not have permission to access this resource."})}u().expand(h),s()}catch(m){s(m)}}))},380:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(896),a=r.n(s),i=r(928),n=r.n(i),o=r(238);function d(e,t){return t.endsWith({mysql:"Mysql",mongo:"Mongo"}[e])}async function l(e,t,s){try{const a=await r(433)((0,o.pathToFileURL)(t).href);if(!a?.default)return void s.logger.warn(`File ${t} has no default export`);"mysql"===e?await async function(e,t,r){const s=e(r.sequelize);!function(e){return"string"==typeof e?.name&&"function"==typeof e}(s)?u(!1,"Sequelize",t,r):(r.sequelize.models[s.name]=s,u(!0,"Sequelize",t,r))}(a.default,t,s):await async function(e,t,r){!function(e){return"string"==typeof e?.modelName}(e(r.mongooseInstance))?u(!1,"Mongoose",t,r):u(!0,"Mongoose",t,r)}(a.default,t,s)}catch(e){s.logger.error(`Error loading model from ${t}:`,e)}}function u(e,t,r,s){if(!s.shouldLogModels)return;const a=`${e?"Valid":"Invalid"} ${t} model: ${r}`;e?s.logger.info(a):s.logger.warn(a)}const c=async function e(t,r,s,i,o=!1,u){const c=a().readdirSync(i,{withFileTypes:!0});for(const a of c){const c=n().join(i,a.name);a.isDirectory()?await e(t,r,s,c,o,u):d(t,a.name)&&await l(t,c,{sequelize:r,mongooseInstance:s,shouldLogModels:o,logger:u})}}},409:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>u});var a=r(252),i=r(259),n=r(314),o=r(871),d=e([i,n]);[i,n]=d.then?(await d)():d;const l=(0,a.Router)();l.post("/create/",o.A.single("profilePicture"),i.A.create),l.post("/login/",i.A.login),l.get("/logout/",i.A.logout),l.put("/update/:userId?",n.B,o.A.single("profilePicture"),i.A.update),l.get("/get/",i.A.getUsers),l.get("/getActive/",n.B,n.m,i.A.getActiveUsers),l.get("/getInactive/",n.B,n.m,i.A.getInactiveUsers),l.get("/self/:userId?",i.A.self),l.delete("/delete/:userId?",n.B,i.A.delete),l.put("/reactivate/:userId?",i.A.reactivate),l.get("/search/",n.B,i.A.searchUsers);const u=l;s()}catch(e){s(e)}}))},433:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=433,e.exports=t},437:e=>{"use strict";e.exports=require("socket.io")},451:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});class s{model;constructor(e){if(this.model=e,new.target===s)throw new Error("DBManager is abstract and cannot be instantiated")}}class a extends s{constructor(e){super(e)}async create(e){return this.model.create(e)}async find(e,t={}){return this.model.find(e).select(t.exclude?.reduce(((e,t)=>({...e,[t]:0})),{})||{}).sort(t.sort).skip(t.skip||0).limit(t.limit||0).exec()}async findOne(e,t={}){return this.model.findOne(e).select(t.exclude?.reduce(((e,t)=>({...e,[t]:0})),{})||{}).exec()}async findById(e,t={}){return this.model.findById(e).select(t.exclude?.reduce(((e,t)=>({...e,[t]:0})),{})||{}).exec()}async findAndCount(e,t={}){const[r,s]=await Promise.all([this.find(e,t),this.model.countDocuments(e).exec()]);return{count:s,rows:r}}async update(e,t){if("object"==typeof e){const r=await this.find(e);return 0===r.length?null:(await this.model.updateMany(e,t).exec(),r[0])}return await this.findById(e)?this.model.findByIdAndUpdate(e,t,{new:!0}).exec():null}async delete(e){await this.model.findByIdAndDelete(e).exec()}async softDelete(e){return this.update(e,{isActive:!1})}async reactivate(e){return this.update(e,{isActive:!0})}buildSearchQuery(e,t){return{$or:t.map((t=>({[t]:{$regex:e,$options:"i"}})))}}buildSort(e,t){return{[e]:"DESC"===t?-1:1}}}var i=r(31);class n extends s{Op;constructor(e){if(super(e),!e.sequelize)throw new Error("Sequelize instance is not defined on the model");this.Op=i.Op}async create(e){return this.model.create(e,{returning:!0})}async find(e,t={}){const r=t.exclude?{exclude:t.exclude}:void 0;return this.model.findAll({where:e,attributes:r,order:t.sort,offset:t.offset,limit:t.limit})}async findOne(e,t={}){const r=t.exclude?{exclude:t.exclude}:void 0;return this.model.findOne({where:e,attributes:r})}async findById(e,t={}){const r=t.exclude?{exclude:t.exclude}:void 0;return this.model.findByPk(e,{attributes:r})}async findAndCount(e,t={}){return this.model.findAndCountAll({where:e,...t})}async update(e,t){if("object"==typeof e){const r=await this.find(e);return 0===r.length?null:(await this.model.update(t,{where:e}),r[0])}{const r=await this.findById(e);return r?(await r.update(t),r):null}}async delete(e){await this.model.destroy({where:{id:e}})}async softDelete(e){return this.update(e,{isActive:!1})}async reactivate(e){return this.update(e,{isActive:!0})}buildSearchQuery(e,t){return{[this.Op.or]:t.map((t=>({[t]:{[this.Op.like]:`%${e}%`}})))}}buildSort(e,t){return[[e,t.toUpperCase()]]}}function o(e){switch(process.env.DB_TYPE){case"mongo":return new a(e);case"mysql":return new n(e);default:throw new Error("Invalid DB_TYPE")}}},461:e=>{"use strict";e.exports=require("multer")},469:e=>{"use strict";e.exports=require("dotenv/config")},479:e=>{"use strict";e.exports=require("connect-mongo")},486:e=>{"use strict";e.exports=require("bcrypt")},510:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>l});var a=r(252),i=r(294),n=r(314),o=e([i,n]);[i,n]=o.then?(await o)():o;const d=(0,a.Router)();d.post("/create",n.B,i.A.create),d.get("/get",n.B,i.A.getUserAddresses),d.get("/get/:addressId?",n.B,i.A.getAddressById),d.get("/get-user-addresses/:userId?",n.B,i.A.getByUserId),d.put("/update/:addressId?",n.B,i.A.update),d.delete("/delete/:addressId?",n.B,i.A.delete),d.put("/set-primary/:userId?/:addressId?",n.B,i.A.setPrimaryAddress),d.get("/primary/:userId?",n.B,i.A.getPrimaryAddress);const l=d;s()}catch(e){s(e)}}))},525:e=>{"use strict";e.exports=require("helmet")},552:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{Od:()=>o,WK:()=>n,Zs:()=>d,tI:()=>l});var a=r(859),i=e([a]);a=(i.then?(await i)():i)[0];const n=(e,t,r)=>(s,a,i)=>{s.db={DB_TYPE:r,mongoose:{connection:e},sequelize:{authenticate:()=>t.authenticate()}},i()},o=(e,t,r)=>{a.v.info("Global middleware"),r()},d=(e,t,r,s)=>{if(e&&"EBADCSRFTOKEN"===e.code)return a.v.error("Invalid CSRF",e,e.code),r.status(403).send("Invalid CSRF token");s()},l=(e,t,r)=>{if(a.v.info("Middleware Test Initialized"),!e.session)return r(new Error("Session is not available"));e.session.nome="teste",r()};s()}catch(e){s(e)}}))},577:e=>{"use strict";e.exports=require("cors")},581:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>y});var a=r(928),i=r.n(a),n=r(252),o=r.n(n),d=r(461),l=r.n(d),u=r(409),c=r(510),h=r(188),v=r(7),p=r(552),m=e([u,c,p]);[u,c,p]=m.then?(await m)():m;const f=o().Router();f.get("/",p.tI,v.u),f.get("/health",(async(e,t)=>{try{let r;"mongo"===e.db.DB_TYPE?r=1===e.db.mongoose?.connection.readyState?"connected":"disconnected":"mysql"===e.db.DB_TYPE?(await(e.db.sequelize?.authenticate()),r="connected"):r="unsupported",t.status(200).json({status:"UP",database:r,timestamp:new Date})}catch(e){t.status(500).json({status:"DOWN",database:"disconnected",error:e.message,timestamp:new Date})}})),f.use("/user",u.A),f.use("/address",c.A),f.use("/validator",h.A);const g=process.env.UPLOAD_DIR||"public/uploads";f.use("/uploads",o().static(i().resolve(g))),f.use(((e,t,r,s)=>{e instanceof l().MulterError?r.status(400).json({error:e.message}):s()}));const y=f;s()}catch(e){s(e)}}))},611:e=>{"use strict";e.exports=require("http")},692:e=>{"use strict";e.exports=require("https")},763:e=>{"use strict";e.exports=require("express-rate-limit")},804:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(31);r(469);const a={dbName:process.env.DB_NAME||"database",dbUser:process.env.DB_USER||"root",dbPassword:process.env.DB_PASSWORD||"",dbHost:process.env.DB_HOST||"localhost",dbPort:Number(process.env.DB_PORT)||3306,dialect:"mysql",logging:!1,retry:{max:5,timeout:6e4}},i=new s.Sequelize(a.dbName,a.dbUser,a.dbPassword,{host:a.dbHost,port:a.dbPort,dialect:a.dialect,logging:a.logging,retry:a.retry})},818:e=>{"use strict";e.exports=require("dotenv")},829:e=>{"use strict";e.exports=require("jsonwebtoken")},845:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var s=r(238),a=r(928),i=r(896),n=r(804);async function o(e,t,r=!0){const s=await i.promises.readdir(e,{withFileTypes:!0});for(const i of s){const s=(0,a.join)(e,i.name);if(i.isDirectory()&&r){const e=await o(s,t,r);if(e)return e}else if(i.isFile()&&t.some((e=>i.name.toLowerCase()===e.toLowerCase())))return s}return null}async function d(e){try{const t=e.split("/").pop().replace(/\.(js|ts)$/,"").replace(/Controller$/,""),i=t.charAt(0).toUpperCase()+t.slice(1),d=(0,a.join)((0,a.dirname)((0,s.fileURLToPath)("file:///C:/Users/enricky.hipolito/Documents/gitjhonson/Node-BoilerPlate/src/utils/getModel.ts")),"../models"),l=process.env.DB_TYPE.toLowerCase(),u="mysql"===l?"Mysql":"Mongo",c=[".ts",".js"],h=(0,a.join)(d,l),v=c.flatMap((e=>[`${t}${u}${e}`,`${i}${u}${e}`,`${t}${e}`,`${i}${e}`]));let p=await o(h,v);if(!p){const e=c.flatMap((e=>[`${t}${u}${e}`,`${i}${u}${e}`,`${t}${e}`,`${i}${e}`]));p=await o(d,e,!1)}if(!p){const e=c.flatMap((e=>[`${t}${u}${e}`,`${i}${u}${e}`,`${t}${"mysql"===l?"Mongo":"Mysql"}${e}`,`${t}${e}`,`${i}${e}`]));p=await o(d,e,!0)}if(!p)throw new Error(`Model file not found for ${t}`);const m=(0,s.pathToFileURL)(p).href,f=await r(219)(m);return"mysql"===l?(0,f.default)(n.A):f.default}catch(t){throw console.error(`Error loading model for ${e}:`,t),new Error(`Failed to load model for ${e}`)}}},857:e=>{"use strict";e.exports=require("connect-session-sequelize")},859:(e,t,r)=>{"use strict";r.a(e,(async(e,s)=>{try{r.d(t,{A:()=>V,v:()=>H});var a=r(818),i=r.n(a),n=r(85),o=r.n(n),d=r(928),l=r.n(d),u=r(252),c=r.n(u),h=r(37),v=r.n(h),p=r(479),m=r.n(p),f=r(857),g=r.n(f),y=r(977),A=r.n(y),I=r(525),w=r.n(I),b=r(139),S=r(763),P=r.n(S),E=r(577),$=r.n(E),N=r(982),D=r.n(N),R=r(124),C=r.n(R),U=r(581),T=r(552),j=r(611),q=r.n(j),B=r(692),x=r.n(B),_=r(896),M=r.n(_),O=r(437),Z=r(380),F=r(804),k=r(78),L=e([U,T]);[U,T]=L.then?(await L)():L;const G=i().config();o().expand(G);class z{app;DB_TYPE;mongoConnectionString;sequelize;mongoose;logger;port;https;host;modelsPath;server=null;io=null;constructor(){this.app=c()(),this.DB_TYPE=this.getDBType(process.env.DB_TYPE),this.mongoConnectionString=process.env.MONGO_DB_CONNECTION_STRING||"mongodb://localhost:27017/test",this.sequelize=F.A,this.mongoose=v(),this.logger=C().createLogger({level:"info",format:C().format.json(),transports:[new(C().transports.Console),new(C().transports.File)({filename:"error.log",level:"error"}),new(C().transports.File)({filename:"combined.log"})]}),this.port=null,this.https=!1,this.host=null,this.modelsPath=l().resolve(process.env.MODELS_PATH||"./src/models"),this.server=null}getDBType(e){return"mysql"===e||"mongo"===e?e:"mongo"}async connectToDatabase(){let e=0;const t=async(t,r,s,a)=>{for(;e<5;)try{return this.logger.info(r),await t(),void this.logger.info(`${r} connected!`)}catch(t){e++,this.logger.error(`${s} attempt ${e} failed:`,t),await new Promise((e=>setTimeout(e,5e3)))}throw new Error(a)};if("mongo"===this.DB_TYPE)await t((()=>v().connect(this.mongoConnectionString)),"MongoDB","MongoDB connection","Failed to connect to MongoDB after multiple attempts");else{if("mysql"!==this.DB_TYPE)throw new Error(`Unsupported database type: ${this.DB_TYPE}`);await t((()=>this.sequelize.authenticate()),"MySQL","MySQL connection","Failed to connect to MySQL after multiple attempts")}}async syncModels(){try{await(0,Z.A)(this.DB_TYPE,this.sequelize,this.mongoose,this.modelsPath,!0,this.logger),"mysql"===this.DB_TYPE?(await this.sequelize.sync({alter:!0}),this.logger.info("All Sequelize models were synchronized successfully.")):"mongo"===this.DB_TYPE&&this.logger.info("All Mongoose models were loaded successfully.")}catch(e){this.logger.error("Error synchronizing models:",e)}}async setupSessionAndFlash(){let e;"mongo"===this.DB_TYPE?e=m().create({client:v().connection.getClient(),dbName:v().connection.name,collectionName:"sessions"}):"mysql"===this.DB_TYPE&&(e=new(g()(A().Store))({db:this.sequelize,tableName:"sessions"}),await e.sync());const t=A()({secret:process.env.SESSION_SECRET||"defaultsecret",store:e,resave:!1,saveUninitialized:!1,cookie:{maxAge:process.env.SESSION_COOKIE_MAX_AGE?parseInt(process.env.SESSION_COOKIE_MAX_AGE):26784e5,httpOnly:!0,secure:!0}});this.app.use(t)}setupCSRFProtection(){const{generateToken:e,doubleCsrfProtection:t}=(0,b.doubleCsrf)({getSecret:e=>{if(!e||!e.session)throw new Error("Session is not initialized");return e.session.csrfSecret||(e.session.csrfSecret=D().randomBytes(32).toString("hex")),e.session.csrfSecret},cookieName:process.env.CSRF_COOKIE_NAME||"csrf-token",cookieOptions:{httpOnly:!0,sameSite:process.env.CSRF_COOKIE_SAMESITE||"strict",secure:!0},size:64,ignoredMethods:["GET","HEAD","OPTIONS"]});this.app.use(((e,t,r)=>{e.session.csrfSecret?r():(e.session.csrfSecret=D().randomBytes(32).toString("hex"),e.session.save((e=>{if(e)return r(e);r()})))})),this.app.use(((e,r,s)=>{if(e.path.startsWith("/uploads"))return s();t(e,r,s)})),this.app.use(((t,r,s)=>{t.path.startsWith("/uploads")||(r.locals.csrfToken=e(t,r)),s()}))}setupGlobalMiddlewaresAndRoutes(){this.app.use((0,T.WK)(this.mongoose.connection,this.sequelize,this.DB_TYPE)),this.app.use(w()());const e=process.env.STATIC_FILE_DIR||"public";this.app.use(c().static(e));const t=P()({windowMs:parseInt(process.env.RATE_LIMIT_WINDOW_MS||"900000"),max:parseInt(process.env.RATE_LIMIT_MAX_REQUESTS||"100")});this.app.use(t),process.env.HTTPS_ENABLED,process.env.ENABLE_CORS,this.app.use($()({origin:"*",credentials:!0})),(0,k.A)(this.app),this.app.use(T.Od),this.app.use(U.A),this.setupCSRFProtection(),this.app.use(((e,t,r)=>{t.status(404).send("404 Not Found")})),this.app.use(T.Zs)}async start(e,t,r){this.port=r,this.https=e,this.host=t;try{await this.connectToDatabase(),await this.syncModels(),await this.setupSessionAndFlash(),process.env.HAS_PAYLOAD_LIMIT,this.app.use(c().json({limit:process.env.MAX_PAYLOAD_SIZE||"50mb"})),this.app.use(c().urlencoded({extended:!0})),this.setupGlobalMiddlewaresAndRoutes();const e=this.https,t=process.env.HTTPS_KEY_PATH,r=process.env.HTTPS_CERT_PATH;if(e&&(!t||!r))throw new Error("HTTPS key or certificate path is not defined in environment variables.");this.server=e?x().createServer({key:M().readFileSync(t,"utf8"),cert:M().readFileSync(r,"utf8")},this.app):q().createServer(this.app),"true"===process.env.WEBSOCKET_ENABLED?(this.io=new O.Server(this.server,{cors:{origin:process.env.FRONTEND_URL||`${e?"https":"http"}://${this.host}:${this.port}`,methods:["GET","POST"]}}),this.io.on("connection",(e=>{this.logger.info(`Socket connected: ${e.id}`),e.on("customEvent",(e=>{this.logger.info(`Received customEvent: ${JSON.stringify(e)}`),this.io?.emit("customEventResponse",{message:"Hello from server!"})})),e.on("disconnect",(()=>{this.logger.info(`Socket disconnected: ${e.id}`)}))})),this.logger.info("WebSocket is enabled and initialized.")):this.logger.info("WebSocket is disabled."),this.server.listen(this.port,this.host,(()=>{const t=e?"https":"http";this.logger.info(`${t.toUpperCase()} Server running on ${t}://${this.host}:${this.port}`)}));const s=async()=>{this.logger.info("Shutting down gracefully..."),this.server&&this.server.close((()=>{this.logger.info("Server closed.")})),"mongo"===this.DB_TYPE?(await this.mongoose.connection.close(),this.logger.info("MongoDB connection closed.")):"mysql"===this.DB_TYPE&&(await this.sequelize.close(),this.logger.info("MySQL connection closed.")),this.logger.info("Process exiting..."),process.exit(0)};process.on("SIGINT",(()=>{this.logger.info("SIGINT received"),s().catch((e=>{this.logger.error("Error during shutdown:",e),process.exit(1)}))})),process.on("SIGTERM",(()=>{this.logger.info("SIGTERM received"),s().catch((e=>{this.logger.error("Error during shutdown:",e),process.exit(1)}))}))}catch(e){this.logger.error("Failed to initialize:",e),console.log(e),e instanceof Error&&this.logger.error(e.stack),process.exit(1)}}}const K=new z,H=K.logger,V=K;s()}catch(e){s(e)}}))},871:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var s=r(461),a=r.n(s),i=r(928),n=r.n(i),o=r(896),d=r.n(o),l=r(982),u=r.n(l);const c=process.env.UPLOAD_DIR||n().resolve("public/uploads");d().existsSync(c)||d().mkdirSync(c,{recursive:!0});const h=a().diskStorage({destination:(e,t,r)=>{r(null,c)},filename:(e,t,r)=>{r(null,(e=>{const t=n().extname(e).toLowerCase(),r=u().randomBytes(8).toString("hex");return`${Date.now()}-${r}${t}`})(t.originalname))}}),v=["image/jpeg","image/png","image/gif"],p={storage:h,fileFilter:(e,t,r)=>{v.includes(t.mimetype)?r(null,!0):r(new Error("Invalid file type. Only JPEG, PNG, and GIF are allowed."))},limits:{fileSize:12582912}},m=a()(p)},896:e=>{"use strict";e.exports=require("fs")},898:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});class s{static passportPatterns={BR:/^[A-Z]{2}\d{6}$/,UK:/^[A-Z0-9]{9}$/,US:/^\d{9}$/,JP:/^[A-Z]{2}\d{7}$/,KR:/^[A-Z]{2}\d{7}$/,CN:/^G\d{8}$|^E\d{7}$/,SG:/^[A-Z]\d{7}[A-Z]$/,AR:/^[A-Z]{3}\d{6}$/,FR:/^\d{2}[A-Z]{2}\d{5}$/,DE:/^[CFGHJKLMNPRTVWXYZ][CFGHJKLMNPRTVWXYZ0-9]{8}$/,RU:/^\d{9}$/,CA:/^[A-Z]{2}\d{6}$/,AU:/^[A-Z]\d{7}$/,IN:/^[A-Z]\d{7}$/,IT:/^[A-Z]{2}\d{7}$/,ES:/^[A-Z]{2}\d{6}$/,MX:/^\d{8}$|^[A-Z]{2}\d{6}$|^[A-Z0-9]{9}$/,TR:/^[A-Z]\d{8}$/,SA:/^[A-Z]{2}\d{7}$/,NL:/^[A-Z]{2}\d{7}$/,SE:/^\d{8}$/,CH:/^[A-Z]\d{7}$/,NZ:/^[A-Z]{2}\d{6}$/,ZA:/^[A-Z]{2}\d{7}$/,AE:/^\d{9}$/,TH:/^[A-Z]\d{7}$/,ID:/^[A-Z]\d{7}$/,MY:/^[A-Z]\d{8}$/,PH:/^[A-Z]\d{7}$/,EG:/^[A-Z]\d{8}$/,GR:/^[A-Z]{2}\d{7}$/,PL:/^[A-Z]{2}\d{7}$/,BE:/^[A-Z]{2}\d{6}$/,AT:/^[A-Z]\d{7}$/,NO:/^\d{8}$/,DK:/^\d{9}$/,FI:/^\d{8}$/,IE:/^[A-Z]{2}\d{7}$/,IL:/^\d{7}$|^\d{8}$/,PT:/^[A-Z]{2}\d{6}$/,HU:/^[A-Z]{2}\d{6}$/,CZ:/^[A-Z]{2}\d{7}$/,SK:/^[A-Z]{2}\d{7}$/,RO:/^[A-Z]{2}\d{7}$/,BG:/^[A-Z]{2}\d{7}$/,HR:/^[A-Z]{2}\d{7}$/,SI:/^[A-Z]{2}\d{7}$/,LT:/^[A-Z]{2}\d{7}$/,LV:/^[A-Z]{2}\d{7}$/,EE:/^[A-Z]{2}\d{7}$/,IS:/^[A-Z]{2}\d{7}$/,MT:/^[A-Z]{2}\d{7}$/,CY:/^[A-Z]{2}\d{7}$/};static countriesWithChecksum=new Set(["FR","DE","RU","UK","US","NL","SE","CH","IE","IT","PL","GR","NO","FI"]);static validatePassport(e,t){if("string"!=typeof e||0===e.trim().length)return{valid:!1,error:"Passport number is required and must be a non-empty string.",status:400};if("string"!=typeof t||2!==t.trim().length)return{valid:!1,error:"Country code must be a 2-character string.",status:400};const r=e.trim().toUpperCase(),a=t.toUpperCase();if(!/^[A-Z0-9]+$/.test(r))return{valid:!1,error:"Passport number contains invalid characters.",status:400};if(!(a in s.passportPatterns))return{valid:!1,error:"Invalid or unsupported country code.",status:400};if(!s.passportPatterns[a].test(r))return{valid:!1,error:"Passport number does not match the country's format.",status:400};if(s.countriesWithChecksum.has(a))if("NO"===a||"FI"===a){if(!this.validateMod11Checksum(r))return{valid:!1,error:"Invalid Mod-11 checksum.",status:400}}else if(!this.validateICAOChecksum(r))return{valid:!1,error:"Invalid ICAO checksum.",status:400};return{valid:!0,error:null,status:200}}static validateICAOChecksum(e){const t=[7,3,1];let r=0;for(let s=0;s<e.length-1;s++){const a=e[s];let i;if(/[A-Z]/.test(a))i=a.charCodeAt(0)-55;else{if(!/\d/.test(a))return!1;i=parseInt(a,10)}r+=i*t[s%3]}return r%10===parseInt(e[e.length-1],10)}static validateMod11Checksum(e){const t=[7,3,1,7,3,1,7,3];let r=0;if(!/^\d+$/.test(e))return!1;for(let s=0;s<e.length-1;s++)r+=parseInt(e[s],10)*t[s%t.length];const s=r%11;return 10!==s&&s===parseInt(e[e.length-1],10)}}const a=s,i=class{static validateFields(e,t={required:!0}){const{username:r,name:s,surname:a,email:i,password:n,role:o}=e,{required:d}=t;if(d){let t=[];if(t=["username","name","surname","email","password"].filter((t=>!e[t])),t.length>0)return{valid:!1,error:`Missing required fields: ${t.join(", ")}`,status:400}}return s&&s.length<2?{valid:!1,error:"Name must be at least 2 characters long.",status:400}:a&&a.length<2?{valid:!1,error:"Surname must be at least 2 characters long.",status:400}:r&&r.length<2?{valid:!1,error:"Username must be at least 2 characters long.",status:400}:i&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)?{valid:!1,error:"Invalid email format.",status:400}:n&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&.]{8,}$/.test(n)?{valid:!1,error:"Password must be at least 8 characters long and include an uppercase letter, a lowercase letter, and a number.",status:400}:o&&!["User","Admin"].includes(o)?{valid:!1,error:'Invalid role. Allowed values are "User" or "Admin".',status:400}:{valid:!0,error:null,status:200}}static validatePassport(e,t){const r=a.validatePassport(e,t);return{valid:r.valid,error:r.error?r.error:null,status:r.valid?200:400}}static validateCPF(e){if(!/^\d{11}$/.test(e))return{valid:!1,error:"Invalid CPF format",status:400};let t,r=0;for(let t=1;t<=9;t++)r+=parseInt(e.charAt(t-1))*(11-t);if(t=10*r%11,10!==t&&11!==t||(t=0),t!==parseInt(e.charAt(9)))return{valid:!1,error:"Invalid CPF checksum",status:400};r=0;for(let t=1;t<=10;t++)r+=parseInt(e.charAt(t-1))*(12-t);return t=10*r%11,10!==t&&11!==t||(t=0),t!==parseInt(e.charAt(10))?{valid:!1,error:"Invalid CPF checksum",status:400}:{valid:!0,error:null,status:200}}static validateRG(e){if("string"!=typeof e)return{valid:!1,error:"Invalid input type"};const t=/^\d{2}\.?\d{3}\.?\d{3}-?[0-9Xx]?$/.test(e.trim());return{valid:t,error:t?null:"Invalid RG format",status:t?200:400}}static validateSUS(e){if(!/^\d{15}$/.test(e))return{valid:!1,error:"Invalid SUS format",status:400};let t=0;for(let r=0;r<15;r++)t+=parseInt(e.charAt(r))*(15-r);const r=t%11==0;return{valid:r,error:r?null:"Invalid SUS checksum",status:r?200:400}}static validateCNH(e){if(!/^\d{11}$/.test(e))return{valid:!1,error:"Invalid CNH format",status:400};let t=0;for(let r=0;r<9;r++)t+=parseInt(e.charAt(r))*(9-r);let r=t%11;10===r&&(r=0);let s=0;for(let t=0;t<9;t++)s+=parseInt(e.charAt(t))*(1+t);let a=s%11;10===a&&(a=0);const i=r===parseInt(e.charAt(9))&&a===parseInt(e.charAt(10));return{valid:i,error:i?null:"Invalid CNH checksum",status:400}}static validateCTPS(e){if(!/^[0-9]{7,8}[-\s]?[0-9]{1,2}$/.test(e))return{valid:!1,error:"Invalid CTPS format",status:400};const t=e.replace(/[-\s]/g,"").padStart(9,"0"),r=t.slice(0,-2),s=t.slice(-2);let a=0;for(let e=0;e<r.length;e++)a+=parseInt(r.charAt(e))*(r.length+1-e);const i=(11-a%11)%10===parseInt(s);return{valid:i,error:i?null:"Invalid CTPS checksum",status:i?200:400}}static validateProfessionalRegistration(e,t){if("string"!=typeof e)return{valid:!1,error:"Invalid input type",status:400};const r=/^\d{4,6}\/[A-Z]{2}$/.test(e.trim());return{valid:r,error:r?null:`Invalid ${t} format`,status:r?200:400}}static validateCRM(e){return this.validateProfessionalRegistration(e,"CRM")}static validateOAB(e){return this.validateProfessionalRegistration(e,"OAB")}static validateCREA(e){return this.validateProfessionalRegistration(e,"CREA")}static validatePIS(e){if(!/^\d{11}$/.test(e))return{valid:!1,error:"Invalid PIS/PASEP format",status:400};const t=[3,2,9,8,7,6,5,4,3,2];let r=0;for(let s=0;s<10;s++)r+=parseInt(e[s])*t[s];let s=r%11;const a=(s<2?0:11-s)===parseInt(e[10]);return{valid:a,error:a?null:"Invalid PIS/PASEP number",status:a?200:400}}static validateCNPJ(e){if(!/^\d{14}$/.test(e))return{valid:!1,error:"Invalid CNPJ format",status:400};const t=(e,t)=>{let r=0;for(let s=0;s<t.length;s++)r+=parseInt(e[s])*t[s];let s=r%11;return s<2?0:11-s},r=t(e,[5,4,3,2,9,8,7,6,5,4,3,2]),s=t(e,[6,5,4,3,2,9,8,7,6,5,4,3,2]),a=r===parseInt(e[12])&&s===parseInt(e[13]);return{valid:a,error:a?null:"Invalid CNPJ number",status:a?200:400}}static validateUSDriversLicense(e){const t=/^[A-Z0-9]{4,16}$/.test(e);return{valid:t,error:t?null:"Invalid US Driver's License format",status:t?200:400}}static validateUSSSN(e){const t=/^(?!000|666|9\d{2})\d{3}-(?!00)\d{2}-(?!0000)\d{4}$/.test(e);return{valid:t,error:t?null:"Invalid SSN format",status:t?200:400}}static validateUSMilitaryID(e){const t=/^[A-Z0-9]{10,12}$/.test(e);return{valid:t,error:t?null:"Invalid US Military ID format",status:t?200:400}}static validateUSGreenCard(e){const t=/^([A-Z]{3}\d{10}|[A-Z]\d{8,9})$/.test(e);return{valid:t,error:t?null:"Invalid Green Card format",status:t?200:400}}static validateUSEAD(e){const t=/^[A-Z]{3}\d{10}$/.test(e);return{valid:t,error:t?null:"Invalid EAD format",status:t?200:400}}static validateUSBirthCertificate(e){const t=/^[A-Z]{2}\d{6,8}$/.test(e);return{valid:t,error:t?null:"Invalid US Birth Certificate format",status:t?200:400}}static validateUSMedicareMedicaid(e){const t=/^[1-9][A-Z]\d{2}-[A-Z]\d{4}-[A-Z]\d{2}$/.test(e);return{valid:t,error:t?null:"Invalid Medicare/Medicaid format",status:t?200:400}}static validateUSVeteranID(e){const t=/^[A-Z0-9]{8,12}$/.test(e);return{valid:t,error:t?null:"Invalid Veteran ID format",status:t?200:400}}static validateUKDrivingLicence(e){const t=/^[A-Z]{5}\d{6}[A-Z]{2}\d{2}$/.test(e);return{valid:t,error:t?null:"Invalid UK Driving Licence format",status:t?200:400}}static validateUKBirthCertificate(e){const t=/^[A-Z]{2}\d{6,8}$/.test(e);return{valid:t,error:t?null:"Invalid UK Birth Certificate format",status:t?200:400}}static validateUKArmedForcesID(e){const t=/^[A-Z]{2}\d{6}$/.test(e);return{valid:t,error:t?null:"Invalid UK Armed Forces ID format",status:t?200:400}}static validateUKNINumber(e){const t=/^(?!BG|GB|NK|KN|TN|NT|ZZ)[A-Z]{2}\d{6}[ABCD]$/.test(e);return{valid:t,error:t?null:"Invalid UK NI Number format",status:t?200:400}}static validateUKResidenceCard(e){const t=/^[A-Z0-9]{12}$/.test(e);return{valid:t,error:t?null:"Invalid UK Residence Card format",status:t?200:400}}static validateCanadianSIN(e){if(!/^\d{9}$/.test(e))return{valid:!1,error:"Invalid SIN format",status:400};const t=(e=>{let t=0;for(let r=0;r<e.length;r++){let s=parseInt(e[r]);r%2==0&&(s*=2,s>9&&(s-=9)),t+=s}return t%10==0})(e);return{valid:t,error:t?null:"Invalid SIN number",status:t?200:400}}static validateMexicanCURP(e){if(!/^[A-Z]{4}\d{6}[HM][A-Z]{5}\d{2}$/.test(e))return{valid:!1,error:"Invalid CURP format",status:400};const t=(e=>{let t=0;for(let r=0;r<17;r++){const s=e[r];t+="0123456789ABCDEFGHIJKLMNÃ‘OPQRSTUVWXYZ".indexOf(s)*(18-r)}let r=10-t%10;return 10===r&&(r=0),r===parseInt(e[17])})(e);return{valid:t,error:t?null:"Invalid CURP checksum",status:t?200:400}}static validateSouthKoreanRRN(e){if(!/^\d{13}$/.test(e))return{valid:!1,error:"Invalid RRN format",status:400};const t=parseInt(e[6]);if(t<1||t>4)return{valid:!1,error:"Invalid gender digit in RRN",status:400};const r=parseInt(e.substring(0,2)),s=parseInt(e.substring(2,4)),a=parseInt(e.substring(4,6));let i;if(1===t||2===t)i=1900+r;else{if(3!==t&&4!==t)return{valid:!1,error:"Invalid gender digit in RRN",status:400};i=2e3+r}const n=new Date(i,s-1,a);if(isNaN(n.getTime()))return{valid:!1,error:"Invalid birthdate in RRN",status:400};const o=(11-[2,3,4,5,6,7,8,9,2,3,4,5].reduce(((t,r,s)=>t+parseInt(e[s])*r),0)%11)%10===parseInt(e[12]);return{valid:o,error:o?null:"Invalid RRN number",status:o?200:400}}static validateGermanPersonalausweis(e){if(!/^\d{10}$/.test(e))return{valid:!1,error:"Invalid format: Must be exactly 10 digits",status:400};const t=[7,3,1,7,3,1,7,3,1];let r=0;for(let s=1;s<10;s++){const a=parseInt(e[s],10);if(isNaN(a))return{valid:!1,error:"Invalid character detected",status:400};r+=a*t[s-1]}const s=r%10,a=parseInt(e[9],10);return isNaN(a)||s!==a?{valid:!1,error:"Invalid checksum",status:400}:{valid:!0,error:null,status:200}}}},928:e=>{"use strict";e.exports=require("path")},977:e=>{"use strict";e.exports=require("express-session")},982:e=>{"use strict";e.exports=require("crypto")},997:(e,t,r)=>{"use strict";r.a(e,(async(e,t)=>{try{var s=r(859),a=(r(469),e([s]));s=(a.then?(await a)():a)[0];const i=parseInt(process.env.PORT||"8765",10),n=process.env.HOST||"localhost",o="true"===process.env.HTTPS_ENABLED||!1;s.A.start(o,n,i),t()}catch(e){t(e)}}))}},i={};function n(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return a[e](r,r.exports,n),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},n.a=(a,i,n)=>{var o;n&&((o=[]).d=-1);var d,l,u,c=new Set,h=a.exports,v=new Promise(((e,t)=>{u=t,l=e}));v[t]=h,v[e]=e=>(o&&e(o),c.forEach(e),v.catch((e=>{}))),a.exports=v,i((a=>{var i;d=(a=>a.map((a=>{if(null!==a&&"object"==typeof a){if(a[e])return a;if(a.then){var i=[];i.d=0,a.then((e=>{n[t]=e,s(i)}),(e=>{n[r]=e,s(i)}));var n={};return n[e]=e=>e(i),n}}var o={};return o[e]=e=>{},o[t]=a,o})))(a);var n=()=>d.map((e=>{if(e[r])throw e[r];return e[t]})),l=new Promise((t=>{(i=()=>t(n)).r=0;var r=e=>e!==o&&!c.has(e)&&(c.add(e),e&&!e.d&&(i.r++,e.push(i)));d.map((t=>t[e](r)))}));return i.r?l:n()}),(e=>(e?u(v[r]=e):l(h),s(o)))),o&&o.d<0&&(o.d=0)},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(997)})();